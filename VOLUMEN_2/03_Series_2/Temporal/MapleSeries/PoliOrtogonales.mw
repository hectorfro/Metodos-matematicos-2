<?xml version="1.0" encoding="UTF-8"?>
<Worksheet><Version major="6" minor="1"/><View-Properties><Zoom percentage="200"/></View-Properties><Styles><Layout alignment="left" bullet="none" firstindent="0.0" leftmargin="0.0" linebreak="space" linespacing="0.0" name="Normal" rightmargin="0.0" spaceabove="0.0" spacebelow="0.0"/><Font background="[0,0,0]" bold="true" executable="true" family="Monospaced" foreground="[255,0,0]" name="Maple Input" opaque="false" size="12"/><Font background="[0,0,0]" bold="false" executable="false" family="Times New Roman" foreground="[0,0,0]" italic="false" name="Text" opaque="false" size="12" underline="false"/></Styles><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input">restart;with(numapprox):Digits :=3;</Text-field></Input></Group><Group><Input><Text-field layout="Normal" style="Text"><Font encoding="ISO8859-1">Se puede expandir una funci\363n polin\363mica en t\351rmino de polinomios ortogonales</Font></Text-field></Input></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input">poli := 1+2*x+3*x^3 +4*x^5;
a := chebyshev(poli,x);</Text-field></Input></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input">restart;with(OrthogonalSeries) :</Text-field></Input></Group><Group><Input><Text-field layout="Normal" style="Text">Igualmente, ese mismo polinomio puede ser expresado en varias bases de polinomios ortogonales</Text-field></Input></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input">poli := 1+2*x+3*x^3 +4*x^5;</Text-field></Input></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input">S1 := ChangeBasis(poli,ChebyshevT(n,x)) ;</Text-field></Input></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input">S2 := ChangeBasis(poli,HermiteH(n,x)) ;</Text-field></Input></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input">S3 := ChangeBasis(S1,HermiteH(n,x));</Text-field></Input></Group><Group><Input><Text-field layout="Normal" style="Text"><Font encoding="ISO8859-1">Los polinomios ortogonales son funciones y como tales se eval\372an</Font></Text-field></Input></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input">LegendreP(2,x);
LegendreP(2,0.3);simplify(%);</Text-field></Input></Group><Group><Input><Text-field layout="Normal" style="Text"><Font encoding="ISO8859-1">igualmente se expresan como series hipergeom\351tricas</Font></Text-field></Input></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input">LegendreP(a,z):
% = convert( %, hypergeom);</Text-field></Input></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input">restart;f(x):=exp(-(x -1/2)^2);</Text-field></Input></Group><Group><Input><Text-field layout="Normal" style="Text"><Font encoding="ISO8859-1">Si suponemos una funci\363n arbitraria se calculan los coeficientes </Font></Text-field></Input></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input">a[n]:=int(LegendreP(n,x)*f(x),x=-1..1)/int(LegendreP(n,x)^2,x=-1..1);</Text-field></Input></Group><Group><Input><Text-field layout="Normal" style="Text"/></Input></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input">N := 5;
for n from 0 to N do
a[n]:=evalf( int(LegendreP(n,x)*f(x),x=-1..1) ) / evalf( int(LegendreP(n,x)^2,x=-1..1)) ;
end do;</Text-field></Input></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input">S(x):= sum(a[j]*LegendreP(j,x),j=0..N); </Text-field></Input></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input">ST(x):= taylor( f(x), x=0, 7+1 );
STP(x):= convert(ST(x), polynom):</Text-field></Input></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input">plot([[x,S(x),x=-1..1],[x,STP(x),x=-1..1],[x,f(x),x=-1..1]],color=[red,blue,black]);</Text-field></Input></Group><Group><Input><Text-field layout="Normal" style="Text"/><Text-field alignment="centred" layout="Normal" style="Text"><Font bold="true" encoding="ISO8859-1">Interpolando puntos a funciones polin\363micas...</Font></Text-field><Text-field layout="Normal" style="Text"/></Input></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input">restart;with(plots):with(CurveFitting):
XYdatos:= [[2, 8], [4,10], [6,11], [8,18], [10,20], [12,34]]: # o equivalentemente con solo puntos
listplot(XYdatos,style = POINT, symbol = DIAMOND, color=red, labels=[`x`,`f(x)`]);</Text-field></Input></Group><Group><Input><Text-field layout="Normal" style="Text">se reescalan al intervalo ('-1,1)</Text-field></Input></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input">Npuntos := 6;</Text-field></Input></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input">for i from 1 to Npuntos do
	XYdatosRE[i,1]:= XYdatos[i,1]/5 +(5-12)/5:
	XYdatosRE[i,2]:= XYdatos[i,2]:
end do:
</Text-field></Input></Group><Group><Input><Text-field layout="Normal" style="Text"><Font encoding="ISO8859-1">Se plantea un sistema de ecuaciones a partir de la expansi\363n del vector como combinaci\363n lineal de los seis primeros polinomios de Legendre</Font></Text-field></Input></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input">for i from 1 to Npuntos do 
	EcuacP[i] := simplify(-XYdatosRE[i,2]+  	sum(C[j]*LegendreP(j,XYdatosRE[i,1]),j=0..(Npuntos-1))=0 );
# latex(%)
end do; ;</Text-field></Input></Group><Group><Input><Text-field layout="Normal" style="Text">Se resuelve el sistema para encontrar las componentes del vector en el subespacio 6 dimensional</Text-field></Input></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input">solve({EcuacP[1],EcuacP[2],EcuacP[3],EcuacP[4],EcuacP[5],EcuacP[6]},{C[0],C[1],C[2],C[3],C[4],C[5]} );assign(%);# latex(%);</Text-field></Input></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input">for i from 1 to Npuntos do 
	EcuacT[i] := simplify(-XYdatosRE[i,2]+  	sum(A[j]*ChebyshevT(j,XYdatosRE[i,1]),j=0..(Npuntos-1))=0 );
end do; </Text-field></Input></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input">solve({EcuacT[1],EcuacT[2],EcuacT[3],EcuacT[4],EcuacT[5],EcuacT[6]},{A[0],A[1],A[2],A[3],A[4],A[5]} );assign(%);</Text-field></Input></Group><Group><Input><Text-field layout="Normal" style="Text"><Font encoding="ISO8859-1">con lo cual el polinomio de interpolaci\363n ser\341</Font></Text-field></Input></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input">PInterpolP(x):=  (sum(C[j]*LegendreP(j,x),j=0..(Npuntos-1)));#latex(%);</Text-field></Input></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input">PInterpolT(x):= evalf(sum(A[j]*ChebyshevT(j,x),j=0..(Npuntos-1)));</Text-field></Input></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input">PInterpolLag(x):= PolynomialInterpolation([
		[XYdatosRE[1,1],XYdatosRE[1,2]],
		[XYdatosRE[2,1],XYdatosRE[2,2]],
		[XYdatosRE[3,1],XYdatosRE[3,2]],
		[XYdatosRE[4,1],XYdatosRE[4,2]],
		[XYdatosRE[5,1],XYdatosRE[5,2]],
		[XYdatosRE[6,1],XYdatosRE[6,2]]],x,form=Lagrange);</Text-field></Input></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input">GrafInterpolP:= plot(PInterpolP(x),x=-1..1,color=green):
GrafInterpolT:= plot(PInterpolT(x),x=-1..1,color=black):
GrafInterpolLag:= plot(PInterpolLag(x),x=-1..1,color=red):</Text-field></Input></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input">GrafPuntos:=listplot([[XYdatosRE[1,1],XYdatosRE[1,2]],
		[XYdatosRE[2,1],XYdatosRE[2,2]],
		[XYdatosRE[3,1],XYdatosRE[3,2]],
		[XYdatosRE[4,1],XYdatosRE[4,2]],
		[XYdatosRE[5,1],XYdatosRE[5,2]],
		[XYdatosRE[6,1],XYdatosRE[6,2]]],
		style = POINT, symbol = DIAMOND, color=blue):</Text-field></Input></Group><Group><Input><Text-field layout="Normal" style="Text">se grafican los puntos y su polinomo de interpolacion</Text-field></Input></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input">display({GrafInterpolP,GrafPuntos}, title = "Puntos e Interpolacion Legendre",labels=[`x`,`f(x)`]);</Text-field></Input></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input">display({GrafInterpolT,GrafPuntos}, title = "Puntos e Interpolacion Tchebyshev");</Text-field></Input></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input">display({GrafInterpolLag,GrafPuntos}, title = "Puntos e Interpolacion Tchebyshev");</Text-field></Input></Group><Group><Input><Text-field alignment="centred" layout="Normal" style="Text"><Font bold="true">Cuadratura de Gauss</Font></Text-field><Text-field layout="Normal" style="Text">Mostraremos la forma que toma la cuadratura de Gauss para n puntos. La cuadratura de Gauss permite expresar una integral como una sumatoria pesada del integrando evaluado en puntos estrat'egicos que son las ra'ices de los polinomios de Legendre.</Text-field></Input></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input">restart;</Text-field></Input></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input">N := 6; 
PNx:=simplify(LegendreP(N,x));</Text-field></Input></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input">x := [fsolve(PNx)];</Text-field></Input></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input">Cuadratura := f -&gt; sum(p['i']*f(x['i']),'i'=1..N);</Text-field></Input></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input">Ecuacs := []:</Text-field></Input></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input">for j from 1 to N do
Ecuacs := [op(Ecuacs), 
	Cuadratura(z -&gt; z^(j-1)) = int(z^(j-1),z=-1..1)]:
end do:
Ecuacs;</Text-field></Input></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input">SistEc := {op(Ecuacs)}:
variab := {seq(p[k],k=1..N)};</Text-field></Input></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input">pesos := solve(SistEc,variab);assign(%);</Text-field></Input></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input">PoliGenerico2N1 := randpoly(z,dense,degree=2*N-1);</Text-field></Input></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input">fpoli := unapply(PoliGenerico2N1,z);</Text-field></Input></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input">IntegCuad:= Cuadratura(fpoli);</Text-field></Input></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input">IntegExact := int(PoliGenerico2N1,z=-1..1);evalf(%);</Text-field></Input></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input">errorCuad:= evalf(IntegExact - IntegCuad);</Text-field></Input></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input">PoliGenerico2N := randpoly(z,dense,degree=2*N);</Text-field></Input></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input">fpoli := unapply(PoliGenerico2N,z);</Text-field></Input></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input">IntegCuad:= Cuadratura(fpoli);</Text-field></Input></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input">IntegExact := int(PoliGenerico2N,z=-1..1);evalf(%);</Text-field></Input></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input">errorCuad:= evalf(IntegExact - IntegCuad);</Text-field></Input></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input">ff:=z-&gt;exp(-(z -1/2)^2);</Text-field></Input></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input">IntegCuad:= Cuadratura(ff);</Text-field></Input></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input">IntegExact := int(ff(z),z=-1..1);evalf(%);</Text-field></Input></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input">errorCuad:= evalf(IntegExact - IntegCuad);</Text-field></Input></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input"/></Input></Group><Text-field/><Text-field/><Text-field/><Text-field/></Worksheet>