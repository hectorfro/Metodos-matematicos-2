<?xml version="1.0" encoding="UTF-8"?>
<Worksheet><Version major="6" minor="1"/><View-Properties><Zoom percentage="150"/></View-Properties><Styles><Layout alignment="left" firstindent="0.0" name="Heading 1" spaceabove="8.0" spacebelow="4.0"/><Layout name="Normal"/><Layout alignment="centred" linespacing="0.5" name="Maple Output"/><Font background="[0,0,0]" bold="true" executable="true" family="Monospaced" foreground="[255,0,0]" name="Maple Input"/><Font background="[0,0,0]" bold="true" name="Heading 1" size="18"/><Font background="[0,0,0]" family="Times New Roman" foreground="[0,0,255]" name="2D Output" underline="false"/><Font background="[0,0,0]" name="Normal"/><Font background="[0,0,0]" family="Times New Roman" name="Page Number" underline="false"/></Styles><Page-Numbers enabled="false" first-number="1" first-numbered-page="1" horizontal-location="right" style="Page Number" vertical-location="bottom"/><Group><Input><Text-field layout="Normal" style="Normal"><Font family="Times New Roman">L-29 MCS 471: Gaussian quadrature</Font></Text-field></Input></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input">restart;</Text-field></Input></Group><Section><Title><Text-field layout="Heading 1" style="Heading 1"><Font family="Times New Roman">Gaussian Quadrature</Font></Text-field></Title><Text-field layout="Normal" style="Normal"><Font family="Times New Roman">We will construct a quadrature rule with n points, using the Legendre polynomials.</Font></Text-field><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input">n := 5;</Text-field></Input><Output><Text-field layout="Maple Output" style="2D Output"><Equation>NiM+SSJuRzYiIiIm</Equation></Text-field></Output></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input">p := orthopoly[P](n,z);</Text-field></Input><Output><Text-field layout="Maple Output" style="2D Output"><Equation>NiM+SSJwRzYiLCgqJEkiekdGJSIiJiMiI2oiIikqJEYoIiIkIyEjTiIiJUYoIyIjOkYs</Equation></Text-field></Output></Group><Group><Input><Text-field layout="Normal" style="Normal"><Font family="Times New Roman">The abscisses are the roots of the Legendre polynomial:</Font></Text-field></Input></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input">x := [fsolve(p)];</Text-field></Input><Output><Text-field layout="Maple Output" style="2D Output"><Equation>NiM+SSJ4RzYiNyckIStmJSl6aCEqISM1JCErLEpwJVEmRikkIiIhRi0kIissSnAlUSZGKSQiK2YlKXpoISpGKQ==</Equation></Text-field></Output></Group><Group><Input><Text-field layout="Normal" style="Normal"><Font family="Times New Roman">Now we can encode our rule as a function, which takes as input a function f and returns the value of the approximations:</Font></Text-field></Input></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input">rule := f -&gt; sum(w['i']*f(x['i']),'i'=1..n);</Text-field></Input><Output><Text-field layout="Maple Output" style="2D Output"><Equation>NiM+SSVydWxlRzYiZio2I0kiZkdGJUYlNiRJKW9wZXJhdG9yR0YlSSZhcnJvd0dGJUYlLUkkc3VtR0YlNiQqJiZJIndHRiU2Iy5JImlHRiUiIiItOSQ2IyZJInhHRiVGMkY1L0YzO0Y1SSJuR0YlRiVGJUYl</Equation></Text-field></Output></Group><Group><Input><Text-field layout="Normal" style="Normal"><Font family="Times New Roman">We determine the weights by solving a linear system, from the first n requirements that all polynomial up to degree n need to be integrated exactly:</Font></Text-field></Input></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input">eqs := []:</Text-field><Text-field layout="Normal" prompt="&gt; " style="Maple Input">for i from 1 to n do</Text-field><Text-field layout="Normal" prompt="&gt; " style="Maple Input">   eqs := [op(eqs),rule(z-&gt;z^(i-1)) = int(z^(i-1),z=-1..1)]:</Text-field><Text-field layout="Normal" prompt="&gt; " style="Maple Input">end do:</Text-field></Input></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input">eqs;</Text-field></Input><Output><Text-field layout="Maple Output" style="2D Output"><Equation>NiM3Jy8sLCZJIndHNiI2IyIiIkYqJkYnNiMiIiNGKiZGJzYjIiIkRiomRic2IyIiJUYqJkYnNiMiIiZGKkYtLywqRiYkIStmJSl6aCEqISM1RiskISssSnAlUSZGO0YxJCIrLEpwJVEmRjtGNCQiK2YlKXpoISpGOyIiIS8sKkYmJCIrSiI+O0ApRjtGKyQiK3o+XCoqR0Y7RjFGR0Y0RkUjRi1GMC8sKkYmJCErZlA/VHVGO0YrJCErWXVHaDpGO0YxJCIrWXVHaDpGO0Y0JCIrZlA/VHVGO0ZCLywqRiYkIit3KW9JdSdGO0YrJCIrUFAwMiUpISM2RjFGWEY0RlYjRi1GNg==</Equation></Text-field></Output></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input">sys := {op(eqs)}:</Text-field></Input></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input">var := {seq(w[k],k=1..n)};</Text-field></Input><Output><Text-field layout="Maple Output" style="2D Output"><Equation>NiM+SSR2YXJHNiI8JyZJIndHRiU2IyIiIiZGKDYjIiIjJkYoNiMiIiQmRig2IyIiJSZGKDYjIiIm</Equation></Text-field></Output></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input">weights := solve(sys,var);</Text-field></Input><Output><Text-field layout="Maple Output" style="2D Output"><Equation>NiM+SSh3ZWlnaHRzRzYiPCcvJkkid0dGJTYjIiIjJCIrMG5HJ3klISM1LyZGKTYjIiIiJCIrXilvI3BCRi4vJkYpNiMiIiZGMy8mRik2IyIiJUYsLyZGKTYjIiIkJCIrKCkpKSkpKW8mRi4=</Equation></Text-field></Output></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input">assign(weights);</Text-field></Input></Group><Group><Input><Text-field layout="Normal" style="Normal"><Font family="Times New Roman">Now we take a random polynomial of degree 2*n - 1:</Font></Text-field></Input></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input">q := randpoly(z,degree=2*n-1);</Text-field></Input><Output><Text-field layout="Maple Output" style="2D Output"><Equation>NiM+SSJxRzYiLC4iI2oiIiIqJEkiekdGJSIiKCIjKCoqJEYqIiImIiNdKiRGKiIiJSIjeiokRioiIiQiI2NGKiIjXA==</Equation></Text-field></Output></Group><Group><Input><Text-field layout="Normal" style="Normal"><Font family="Times New Roman">turn it into a function</Font></Text-field></Input></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input">fq := unapply(q,z);</Text-field></Input><Output><Text-field layout="Maple Output" style="2D Output"><Equation style="2D Output">NiM+JSNmcUdmKjYjJSJ6RzYiNiQlKW9wZXJhdG9yRyUmYXJyb3dHRigsLiokKTkkIiIoIiIiIiMoKiomIiNdRjEpRi8iIiZGMUYxKiYiI3pGMSlGLyIiJUYxRjEqJiIjY0YxKUYvIiIkRjFGMSomIiNcRjFGL0YxRjEiI2pGMUYoRihGKA==</Equation></Text-field></Output></Group><Group><Input><Text-field layout="Normal" style="Normal"><Font family="Times New Roman">and apply the rule</Font></Text-field></Input></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input">computed := rule(fq);</Text-field></Input><Output><Text-field layout="Maple Output" style="2D Output"><Equation style="2D Output">NiM+JSljb21wdXRlZEckIisrKyt3OiEiKA==</Equation></Text-field></Output></Group><Group><Input><Text-field layout="Normal" style="Normal"><Font family="Times New Roman">and compare with the exact value:</Font></Text-field></Input></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input">exact := int(q,z=-1..1);</Text-field></Input><Output><Text-field layout="Maple Output" style="2D Output"><Equation style="2D Output">NiM+JSZleGFjdEcjIiQpeSIiJg==</Equation></Text-field></Output></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input">exact - computed;</Text-field></Input><Output><Text-field layout="Maple Output" style="2D Output"><Equation style="2D Output">NiMkIiIhRiQ=</Equation></Text-field></Output></Group><Group><Input><Text-field layout="Normal" style="Normal"><Font family="Times New Roman">Roundoff may occur, related to our working precision.</Font></Text-field></Input></Group><Group><Input><Text-field layout="Normal" style="Normal"><Font family="Times New Roman">Now let us see what happens at degree 2*n (this time we take a dense polynomial):</Font></Text-field></Input></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input">q := randpoly(z,dense,degree=2*n);</Text-field></Input><Output><Text-field layout="Maple Output" style="2D Output"><Equation style="2D Output">NiM+JSJxRyw4KiQpJSJ6RyIjNSIiIiIjZComIiNmRiopRigiIipGKiEiIiomIiNYRiopRigiIilGKkYqKiZGNEYqKUYoIiIoRipGMComIiMkKkYqKUYoIiInRipGMComIiMjKkYqKUYoIiImRipGKiomIiNWRiopRigiIiVGKkYqKiYiI2lGKilGKCIiJEYqRjAqJiIjeEYqKUYoIiIjRipGKiomIiNtRipGKEYqRioiI2FGKg==</Equation></Text-field></Output></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input">fq := unapply(q,z);</Text-field></Input><Output><Text-field layout="Maple Output" style="2D Output"><Equation style="2D Output">NiM+JSNmcUdmKjYjJSJ6RzYiNiQlKW9wZXJhdG9yRyUmYXJyb3dHRigsOCokKTkkIiM1IiIiIiNkKiYiI2ZGMSlGLyIiKkYxISIiKiYiI1hGMSlGLyIiKUYxRjEqJkY7RjEpRi8iIihGMUY3KiYiIyQqRjEpRi8iIidGMUY3KiYiIyMqRjEpRi8iIiZGMUYxKiYiI1ZGMSlGLyIiJUYxRjEqJiIjaUYxKUYvIiIkRjFGNyomIiN4RjEpRi8iIiNGMUYxKiYiI21GMUYvRjFGMSIjYUYxRihGKEYo</Equation></Text-field></Output></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input">computed := rule(fq);</Text-field></Input><Output><Text-field layout="Maple Output" style="2D Output"><Equation style="2D Output">NiM+JSljb21wdXRlZEckIit5VWUsPCEiKA==</Equation></Text-field></Output></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input">exact := int(q,z=-1..1);</Text-field></Input><Output><Text-field layout="Maple Output" style="2D Output"><Equation style="2D Output">NiM+JSZleGFjdEcjIidFbj4iJWI2</Equation></Text-field></Output></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input">exact-computed;</Text-field></Input><Output><Text-field layout="Maple Output" style="2D Output"><Equation style="2D Output">NiMkIihMNm4iISIo</Equation></Text-field></Output></Group><Group><Input><Text-field layout="Normal" style="Normal"><Font family="Times New Roman">Here we see that a polynomial of degree 2*n is no longer integrated exactly.</Font></Text-field></Input></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input">?Legendre</Text-field></Input></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input"/></Input></Group></Section><Text-field/><Text-field/><Text-field/></Worksheet>